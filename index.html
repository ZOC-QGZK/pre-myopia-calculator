document.getElementById('predictionForm').addEventListener('submit', async function (event) {
    event.preventDefault();

    const group = document.getElementById('group').value;
    const genddeer = document.getElementById('genddeer').value;
    const variable2 = parseFloat(document.getElementById('variable2').value);
    const preall = parseFloat(document.getElementById('preall').value);
    const paresdasda = parseInt(document.getElementById('paresdasda').value, 10);

    try {
        document.getElementById('result').style.display = 'none';
        document.getElementById('result').classList.remove('alert-success', 'alert-danger');

        const response = await fetch('https://school-myopia-onset-final.glitch.me/predict', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                model_group: group,
                inputs: {
                    genddeer: genddeer,
                    variable2: variable2,
                    preall: preall,
                    paresdasda: paresdasda
                }
            })
        });

        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const result = await response.json();
        let resultDisplay = `<h3>Prediction Result:</h3>`;
        for (const [year, prediction] of Object.entries(result)) {
            resultDisplay += `<p>Myopia-onset risk probability ${year.replace('_', ' ')}: <strong>${prediction.probability}</strong></p>`;
            resultDisplay += `<p>95% CI: [${prediction.confidence_interval[0]}, ${prediction.confidence_interval[1]}]</p>`;
        }

        document.getElementById('result').innerHTML = resultDisplay;
        document.getElementById('result').classList.add('alert-success');
        document.getElementById('result').style.display = 'block';

    } catch (error) {
        console.error('Error:', error);
        document.getElementById('result').innerHTML = `<p>Error: ${error.message}</p>`;
        document.getElementById('result').classList.add('alert-danger');
        document.getElementById('result').style.display = 'block';
    }
});
